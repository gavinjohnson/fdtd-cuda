% H-field updates
Hx(1:Nx,1:Ny-1,1:Nz-1) = Hx(1:Nx,1:Ny-1,1:Nz-1) - ...
    cHxy(1:Nx,1:Ny-1,1:Nz-1) .* (Ez(1:Nx,2:Ny,1:Nz-1)-Ez(1:Nx,1:Ny-1,1:Nz-1)) + ...
    cHxz(1:Nx,1:Ny-1,1:Nz-1) .* (Ey(1:Nx,1:Ny-1,2:Nz)-Ey(1:Nx,1:Ny-1,1:Nz-1));

Hy(1:Nx-1,1:Ny,1:Nz-1) = Hy(1:Nx-1,1:Ny,1:Nz-1) - ...
    cHyz(1:Nx-1,1:Ny,1:Nz-1) .* (Ex(1:Nx-1,1:Ny,2:Nz)-Ex(1:Nx-1,1:Ny,1:Nz-1)) + ...
    cHyx(1:Nx-1,1:Ny,1:Nz-1) .* (Ez(2:Nx,1:Ny,1:Nz-1)-Ez(1:Nx-1,1:Ny,1:Nz-1));

Hz(1:Nx-1,1:Ny-1,1:Nz) = Hz(1:Nx-1,1:Ny-1,1:Nz) - ...
    cHzx(1:Nx-1,1:Ny-1,1:Nz) .* (Ey(2:Nx,1:Ny-1,1:Nz)-Ey(1:Nx-1,1:Ny-1,1:Nz)) + ...
    cHzy(1:Nx-1,1:Ny-1,1:Nz) .* (Ex(1:Nx-1,2:Ny,1:Nz)-Ex(1:Nx-1,1:Ny-1,1:Nz));

% call the H source update subroutine
HsrcUpdate;